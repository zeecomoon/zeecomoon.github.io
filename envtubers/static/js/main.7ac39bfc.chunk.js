(this.webpackJsonpenvtubers=this.webpackJsonpenvtubers||[]).push([[0],{22:function(e,t,n){e.exports=n(34)},27:function(e,t,n){},34:function(e,t,n){"use strict";n.r(t);var a,r,s=n(0),l=n.n(s),c=n(19),i=n.n(c),o=n(20),u=n(1),m=(n(27),n(9)),h=n(10),d=n(12),p=n(11),v=n(8),f=n.n(v),E=n(14);function g(){return new Headers({Accept:"application/vnd.twitchtv.v5+json","Client-ID":"rt0aq3avxhv3qoj9kqkvdoi48rrz7e"})}function w(){return(w=Object(E.a)(f.a.mark((function e(t){var n,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=N(t,100),a=n.map((function(e){var t=new Request("https://api.twitch.tv/kraken/channels?id="+e.join(","),{method:"GET",headers:g()});return fetch(t).then(b).then((function(e){return e.json()}))})),e.abrupt("return",Promise.all(a).then((function(e){return e.map((function(e){return e.channels})).flat()})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(){return(y=Object(E.a)(f.a.mark((function e(t){var n,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=N(t,100),a=n.map((function(e){var t=new Request("https://api.twitch.tv/kraken/streams?channel="+e.join(","),{method:"GET",headers:g()});return fetch(t).then(b).then((function(e){return e.json()}))})),e.abrupt("return",Promise.all(a).then((function(e){return e.map((function(e){return e.streams}))})).then((function(e){return e.flat()})).then((function(e){return e.map((function(e){return e.channel.stream=e,e.channel}))})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){if(!e.ok)throw Error(e.statusText);return e}function N(e,t){return Array.from({length:Math.ceil(e.length/t)},(function(n,a){return e.slice(a*t,a*t+t)}))}!function(e){e.Viewers="Viewers",e.Name="Name",e.Followers="Followers",e.Game="Game",e.Random="Random"}(a||(a={})),function(e){e.Live="Live",e.All="All"}(r||(r={}));var C=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(m.a)(this,n);for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];return(e=t.call.apply(t,[this].concat(l))).state={filterBy:r.Live,sortBy:a.Viewers,sortDescending:!0},e}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){return e.props.onChange(e.sort(e.props.channels,e.props.liveChannels))}),500),setTimeout((function(){return e.props.onChange(e.sort(e.props.channels,e.props.liveChannels))}),1e3),setTimeout((function(){return e.props.onChange(e.sort(e.props.channels,e.props.liveChannels))}),2e3)}},{key:"componentDidUpdate",value:function(e,t){e.channels===this.props.channels&&e.liveChannels===this.props.liveChannels&&t.filterBy===this.state.filterBy&&t.sortBy===this.state.sortBy&&t.sortDescending===this.state.sortDescending||this.props.onChange(this.sort(this.props.channels,this.props.liveChannels))}},{key:"sort",value:function(e,t){var n=[];return n=function(e,t){switch(t){case a.Followers:return e.sort(j);case a.Viewers:return e.sort(D);case a.Name:return e.sort(S);case a.Game:return e.sort(x);case a.Random:return function(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),a=[e[n],e[t]];e[t]=a[0],e[n]=a[1]}return e}(e)}}(n=this.state.filterBy===r.Live?t:e,this.state.sortBy),this.state.sortDescending||(n=n.reverse()),this.state.sortBy===a.Game&&(n=n.filter((function(e){return""!==e.game}))),n}},{key:"setFilter",value:function(e){e===r.All&&this.state.filterBy!==e&&this.state.sortBy===a.Viewers&&this.setState({sortBy:a.Followers,sortDescending:!0}),this.setState({filterBy:e})}},{key:"setSort",value:function(e){this.state.sortBy===e?this.setState({sortDescending:!this.state.sortDescending}):this.setState({sortBy:e,sortDescending:e!==a.Name&&e!==a.Game})}},{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"top"},l.a.createElement("div",{className:"filterBy"},l.a.createElement("div",{className:"optionDescription"},"Filter By"),l.a.createElement("div",{className:"optionValues"},Object.values(r).map((function(t){return l.a.createElement("div",{key:t},l.a.createElement(B,{onClick:function(){return e.setFilter(t)},type:t,selected:e.state.filterBy===t}))})))),l.a.createElement("div",{className:"sortBy"},l.a.createElement("div",{className:"optionDescription"},"Sort By\xa0\xa0"),l.a.createElement("div",{className:"sortValues"},Object.values(a).map((function(t){return l.a.createElement("div",{key:t},l.a.createElement(k,{onClick:function(){return e.setSort(t)},type:t,selected:e.state.sortBy===t,sortDescending:e.state.sortDescending}))})))))}}]),n}(l.a.Component);function k(e){var t=e.selected?"buttonEnabled":"buttonDisabled",n=e.sortDescending?"\u25bc":"\u25b2",r=e.selected&&e.type!==a.Random;return l.a.createElement("span",{className:"sortValue"},l.a.createElement("span",{className:"sortButton"},l.a.createElement("button",{className:t,onClick:function(){return e.onClick(e.type)}},e.type)),l.a.createElement("span",{className:"sortArrow"},l.a.createElement("button",{onClick:function(){return e.onClick(e.type)}},r&&n)))}function B(e){var t=e.selected?"buttonEnabled":"buttonDisabled";return l.a.createElement("button",{className:t,onClick:function(){return e.onClick(e.type)}},e.type)}function D(e,t){if(null===e.stream&&null===t.stream)return t.followers-e.followers;var n=null!==e.stream?e.stream.viewers:0;return(null!==t.stream?t.stream.viewers:0)-n}function j(e,t){return t.followers-e.followers}function S(e,t){return t.display_name.localeCompare(e.display_name)}function x(e,t){return t.game.localeCompare(e.game)}function L(e){return l.a.createElement("div",{className:"streamer"},l.a.createElement("div",null,l.a.createElement("a",{href:e.channel.url},l.a.createElement("img",{alt:"Channel Logo for "+e.channel.display_name,id:e.channel.name+"-profile",className:"lozad profile-pic circle","data-src":e.channel.logo.replace("300x300","150x150")})),l.a.createElement("div",null,l.a.createElement("div",null,l.a.createElement("a",{className:"displayName",href:e.channel.url},e.channel.display_name),e.channel.partner&&l.a.createElement("img",{alt:"Twith partner badge",className:"partnerBadge",src:"/envtubers/partner.png"})),l.a.createElement("div",null,l.a.createElement("strong",null,e.channel.followers)," followers"),l.a.createElement("div",null,e.channel.twitter&&l.a.createElement("a",{href:"https://twitter.com/"+e.channel.twitter},l.a.createElement("img",{alt:"Twitter logo",className:"twitterLogo",src:"/envtubers/twitter.png"})),e.channel.socials&&e.channel.socials.youtube&&l.a.createElement("a",{href:e.channel.socials.youtube},l.a.createElement("img",{alt:"Youtube logo",className:"youtubeLogo",src:"/envtubers/youtube.png"})),e.channel.socials&&e.channel.socials.instagram&&l.a.createElement("a",{href:e.channel.socials.instagram},l.a.createElement("img",{alt:"Instagram logo",className:"instagramLogo",src:"/envtubers/instagram.png"})),e.channel.socials&&e.channel.socials.discord&&l.a.createElement("a",{href:e.channel.socials.discord},l.a.createElement("img",{alt:"Discord logo",className:"discordLogo",src:"/envtubers/discord.png"}))))),l.a.createElement("div",{className:"description card grey darken-4"},e.channel.description.slice(0,350)))}function O(e){var t,n=(t=e.channel,function(){if(t.stream)return{viewers:l.a.createElement("span",null,l.a.createElement("strong",null,t.stream.viewers)," viewers"),image:t.stream.preview.large+"#"+Date.now()};var e=t.video_banner;return null!==e&&(e=e.replace("1920x1080","426x240")),{viewers:l.a.createElement("strong",null,"Offline"),image:e}}());return l.a.createElement("div",{className:"playing"},l.a.createElement("div",{className:"previewContainer"},n.image&&l.a.createElement("span",null,!1,null!==e.channel.stream&&l.a.createElement("span",{className:"liveIndicator"},"Live"),l.a.createElement("a",{href:e.channel.url},l.a.createElement("img",{alt:"Stream preview for "+e.channel.display_name,id:e.channel.name+"-preview",className:"lozad","data-src":n.image})))),l.a.createElement("div",null,l.a.createElement("div",{className:"streamInfo"},l.a.createElement("a",{href:"https://www.twitch.tv/directory/game/"+e.channel.game},e.channel.game)," ",l.a.createElement("div",null,n.viewers)),l.a.createElement("div",{className:"divider"}),l.a.createElement("div",null,e.channel.status)))}function _(e,t){return 0===e.length?[]:(e.forEach((function(e){return e.stream=null})),t.forEach((function(t){var n=e.filter((function(e){return e._id===t._id}))[0];n.stream=t.stream,t.twitter=n.twitter,t.socials=n.socials})),e)}var A=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(m.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={isLoaded:!1,isError:!1,channels:[],liveChannels:[],shownChannels:[],observer:window.lozad(".lozad",{enableAutoReload:!0})},e}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=this;fetch("/envtubers/vtubers.json").then((function(e){return e.json()})).then((function(t){e.updateChannels(t),e.updateStreams(t),setInterval((function(){return e.updateStreams(t)}),6e5)}))}},{key:"componentDidUpdate",value:function(){this.state.observer.observe()}},{key:"updateChannels",value:function(e){var t=this;(function(e){return w.apply(this,arguments)})(e.map((function(e){return e.user_id}))).then((function(t){return t.map((function(t){var n=e.filter((function(e){return parseInt(e.user_id)===t._id}))[0];return t.twitter=n.twitter,t.socials=n.socials,t}))})).then((function(e){t.setState({channels:_(e,t.state.liveChannels)})})).catch((function(e){t.state.isLoaded||t.setState({isError:!0})}))}},{key:"updateStreams",value:function(e){var t=this;(function(e){return y.apply(this,arguments)})(e.map((function(e){return e.user_id}))).then((function(e){t.setState({isLoaded:!0,liveChannels:e,channels:_(t.state.channels,e)})})).catch((function(e){console.log(e),t.state.isLoaded||t.setState({isError:!0})}))}},{key:"updateShownChannels",value:function(e){this.setState({shownChannels:e})}},{key:"render",value:function(){var e=this,t="Loading your anime waifus and husbandos now...";return this.state.isError&&(t="Error loading data :( Try refreshing"),this.state.isLoaded?l.a.createElement("div",{className:"col s12 m10 l8 xl6"},l.a.createElement(C,{onChange:function(t){return e.updateShownChannels(t)},channels:this.state.channels,liveChannels:this.state.liveChannels}),l.a.createElement("div",{id:"live-channels"},this.state.shownChannels.map((function(e){return l.a.createElement("div",{className:"live-channel card grey-text lighten-5",key:e._id},l.a.createElement(L,{channel:e}),l.a.createElement(O,{channel:e}))})))):l.a.createElement("div",{id:"live-channels",className:"col s12 m10 l8 xl6"},l.a.createElement("div",{className:"live-channel card grey-text lighten-5"},t))}}]),n}(l.a.Component);var T=function(){return l.a.createElement(o.a,null,l.a.createElement("div",{className:"App"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col s0 m1 l2 xl3"}),l.a.createElement("div",{className:"col s12 m10 l8 xl6"},l.a.createElement("div",{id:"nav",className:"nav-wrapper purple lighten-3"},l.a.createElement("div",{id:"logo",className:"title"},"EN VTubers"))),l.a.createElement("div",{className:"col s0 m1 l2 xl3"})),l.a.createElement("div",{id:"page",className:"row"},l.a.createElement("div",{className:"col s0 m1 l2 xl3"}),l.a.createElement(u.c,null,l.a.createElement(u.a,{path:"/"},l.a.createElement(A,null))),l.a.createElement("div",{className:"col s0 m1 l2 xl3"}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(T,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[22,1,2]]]);
//# sourceMappingURL=main.7ac39bfc.chunk.js.map